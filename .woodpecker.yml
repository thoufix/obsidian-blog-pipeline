when:
  event: [push, manual]

steps:
  build:
    image: gohugoio/hugo:extended
    commands:
      - cd hugo-site
      - hugo --minify

  deploy:
    image: alpine:latest
    volumes:
      - /srv/blog:/srv/blog
    commands:
      - rm -rf /srv/blog/public/*
      - cp -r hugo-site/public/* /srv/blog/public/
